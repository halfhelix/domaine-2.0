---
import Layout from '../../layouts/Layout.astro';
import { getProjects } from '../../utils/sanityClient';
import ProjectHero from '../../components/sections/project/Project_Hero.astro'
import ProjectInfo from '../../components/sections/project/Project_Info.astro';
import SectionBlock from '../../components/sections/SectionBlock.astro'
import RelatedProjects from '../../components/sections/project/Project_RelatedProjects.astro';

interface Props {
	data: any
}

export async function getStaticPaths() {

  const projects = await getProjects();

  return projects.map((project) => {
    return {
      params: { slug: project.slug.current },
      props: { data: project }
    }
  })
}

const { slug } = Astro.params;
const { data } = Astro.props;
// console.log(data)
---

<Layout
  title="Project"
  theme="light"
  title={data.title}
>
  <ProjectHero
    title={data.title}
    image={data.mainImage}
  />
  <ProjectInfo 
    excerpt={data.excerpt}
    description={data.description}
    tags={data.tags}
  />
    {data.content ? data.content.map((block) => (
      <SectionBlock block={block} />
    )) : ''}

    <RelatedProjects 
      project={data}
    />
</Layout>