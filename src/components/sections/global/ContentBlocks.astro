---
import { urlFor } from '../../../utils/sanityClient'
import SanityImage from '../../atoms/SanityImage.astro';
const { content } = Astro.props;
console.log(content)

---
<section class="content-blocks" data-inverted={content.invertTextColor ? "true" : "false"} style={`background-color:${content.backgroundColor ? content.backgroundColor.hex : 'transparent'}`}>
  {content.blocks.length > 0 ?
   content.blocks.map((block) => 


    <span class="content-block">
      <div class="media" data-layout={content.blocks.length > 1 ? "half-width" : "full-width"}>

        {block.videoURL ?
          <video
            class="video"
            src={block.videoURL}
            poster={urlFor(block.image).auto('format').url()}
            autoplay
            loop
            muted
            playsinline
          />
        :
        <SanityImage
          image={block.image}
          sizes={content.blocks.length > 1 ? '(max-width: 768px) 100vw, 50vw' : '100vw'}
          aspectRatio={content.blocks.length > 1 ? 3 / 4 : null }
        />
        }
      </div>
      { block.heading || block.description ?
        <div class="content">
          { block.heading && <h3 class="h5">{block.heading}</h3>}
          { block.description && <p>{block.description}</p>}
        </div>
      : null }
    </span>
    
   )
  : null}
</section>

<style>
  .content-blocks {
    display: flex;
    flex-direction: row;
    padding: var(--page-margin);
    gap: var(--space-md);
  }

  .content-blocks[data-inverted="true"] {
    color: var(--color-reverse);
  }

  .content-block {
    display: flex;
    flex-direction: column;
    gap: var(--space-md);
    flex: 1 1 50%;
  }

  .media {
    border-radius: var(--radius-lg);
    overflow: hidden;
    height: auto;
    /* flex: 1 1 50%; */
  }

  /* .media[data-layout="full-width"] {
  }

  .media[data-layout="half-width"] {
    aspect-ratio: 3 / 4;
  }

  .image,
  .video {
    width: 100%;
    height: 100%;
    object-fit: cover;
  } */

  .content {
    max-width: 60ch;
  }

  @media screen and (max-width: 768px) {
    .content-blocks {
      flex-direction: column;
      align-items: stretch;
    }
  }
</style>