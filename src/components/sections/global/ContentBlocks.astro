---
import { urlFor } from '../../../utils/sanityClient'
const { content } = Astro.props;
// console.log(content)

---
<section class="content-blocks" data-inverted={content.invertTextColor ? "true" : "false"} style={`background-color:${content.backgroundColor ? content.backgroundColor.hex : 'transparent'}`}>
  {content.blocks.length > 0 ?
   content.blocks.map((block) => 


    <span class="content-block">
      <div class="media" data-layout={content.blocks.length > 1 ? "half-width" : "full-width"}>

        {block.media.videoURL ?
          <video
            class="video"
            src={block.media.videoURL}
            poster={urlFor(block.media.image).url()}
            autoplay
            loop
            muted
          />
        :
        content.blocks.length > 1 ? (
          <img
            class="image half-width"
            width={block.media.imageMetadata.width}
            height={block.media.imageMetadata.height}
            src={urlFor(block.media.image).url()}
          />
        ) : 
          <img
            class="image full-width"
            width={block.media.imageMetadata.width}
            height={block.media.imageMetadata.height}
            src={urlFor(block.media.image).url()}
          />
        }
      </div>
      { block.heading || block.description ?
        <div class="content">
          { block.heading && <h3 class="h5">{block.heading}</h3>}
          { block.description && <p>{block.description}</p>}
        </div>
      : null }
    </span>
    
   )
  : <h1>"No Blocks"</h1>}
</section>

<style>
  .content-blocks {
    display: flex;
    flex-direction: row;
    padding: var(--page-margin);
    gap: var(--space-md);
  }

  .content-block {
    display: flex;
    flex-direction: column;
    gap: var(--space-md);
    flex: 1 1 50%;
  }

  .media {
    border-radius: var(--radius-lg);
    overflow: hidden;
    height: auto;
    /* flex: 1 1 50%; */
  }

  .media[data-layout="full-width"] {
    /* aspect-ratio: 2 / 1; */
    /* flex: 0 1 50%; */
    max-height: 80svh;
  }

  .media[data-layout="half-width"] {
    aspect-ratio: 3 / 4;
    /* flex: 0 1 50%; */
  }

  .image,
  .video {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .content {
    max-width: 60ch;
  }
</style>